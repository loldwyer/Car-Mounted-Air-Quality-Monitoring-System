<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Car-Mounted Air Quality Dashboard</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

    <!-- Header -->
<header>
  <div class="header-layout">
    
    <div class="logo-container">
      <img src="images/dcu_logo.jpg" class="dcu-logo-left" alt="DCU Logo" />
    </div>

    <div class="header-content">
      <h1>Car Portable Urban Air Quality Monitor</h1>
      <p class="tagline">Live CO₂, PM, NO₂ readings from ESP32 utilising Blynk + ThingSpeak</p>
      <p class="author">Lauren Dwyer | Student No. 38529 | MECE1</p>
    </div>
  </div>
</header>


  <nav class="topnav">
  <ul>
    <li><a href="#" onclick="showSection('sensor-overview')" class="navlink active">Sensor Overview</a></li>
    <li><a href="#" onclick="showSection('hardware')" class="navlink">Hardware</a></li>
    <li><a href="#" onclick="showSection('enclosure')" class="navlink">Enclosure & Mounting</a></li>
    <li><a href="#" onclick="showSection('deployment')" class="navlink">Deployment</a></li>
  </ul>
</nav>

  <!-- Sensor Section -->
  <section id="sensor-overview">
    <h2>Sensor Overview</h2>

    <label for="sensorSelect"><strong>View by Sensor:</strong></label>
    <select id="sensorSelect" onchange="handleSensorSelect(this.value)">
      <option value="none">-- Select --</option>
      <option value="scd30">SCD30 (CO₂, Temp, RH)</option>
      <option value="sps30">SPS30 (PM1.0, PM2.5, PM10)</option>
      <option value="mics">MiCS-4514 (NO₂)</option>
    </select>

    <div class="tabs">
      <button class="tablink" onclick="showTab('co2', this)">CO₂</button>
      <button class="tablink" onclick="showTab('pm25', this)">PM2.5</button>
      <button class="tablink" onclick="showTab('pm10', this)">PM10</button>
      <button class="tablink" onclick="showTab('pm1', this)">PM1.0</button>
      <button class="tablink" onclick="showTab('temp', this)">Temp</button>
      <button class="tablink" onclick="showTab('rh', this)">Humidity</button>
      <button class="tablink" onclick="showTab('no2', this)">NO₂</button>
    </div>

    <div id="sensorTabs" class="tab-group">
      <div id="co2" class="tabcontent tab-box">
        <p><strong>Latest CO₂:</strong> <span id="co2val">Loading...</span> ppm</p>
        <iframe src="https://thingspeak.com/channels/2960675/charts/4?dynamic=true&w=1000&h=400"></iframe>
      </div>

      <div id="pm25" class="tabcontent tab-box">
        <p><strong>Latest PM2.5:</strong> <span id="pm25val">Loading...</span> µg/m³</p>
        <iframe src="https://thingspeak.com/channels/2960675/charts/2?dynamic=true&w=1000&h=400"></iframe>
      </div>

      <div id="pm10" class="tabcontent tab-box">
        <p><strong>Latest PM10:</strong> <span id="pm10val">Loading...</span> µg/m³</p>
        <iframe src="https://thingspeak.com/channels/2960675/charts/3?dynamic=true&w=1000&h=400"></iframe>
      </div>

      <div id="pm1" class="tabcontent tab-box">
        <p><strong>Latest PM1.0:</strong> <span id="pm1val">Loading...</span> µg/m³</p>
        <iframe src="https://thingspeak.com/channels/2960675/charts/1?dynamic=true&w=1000&h=400"></iframe>
      </div>

      <div id="temp" class="tabcontent tab-box">
        <p><strong>Latest Temp:</strong> <span id="tempval">Loading...</span> °C</p>
        <iframe src="https://thingspeak.com/channels/2960675/charts/5?dynamic=true&w=1000&h=400"></iframe>
      </div>

      <div id="rh" class="tabcontent tab-box">
        <p><strong>Latest Humidity:</strong> <span id="humval">Loading...</span> %</p>
        <iframe src="https://thingspeak.com/channels/2960675/charts/6?dynamic=true&w=1000&h=400"></iframe>
      </div>

      <div id="no2" class="tabcontent tab-box">
        <p><strong>Latest NO₂ Voltage:</strong> <span id="no2val">Loading...</span> V</p>
        <iframe src="https://thingspeak.com/channels/2960675/charts/7?dynamic=true&w=1000&h=400"></iframe>
      </div>
    </div>
  </section>

  <!-- Hardware Section -->
  <section id="hardware">
    <h2>Hardware Overview</h2>
    <p>This system uses the following components:</p>
    <ul>
      <li><a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32/esp32-devkitc/user_guide.html" target="_blank">ESP32-DEVKITC-VE</a></li>
      <li><a href="https://sensirion.com/media/documents/4EAF6AF8/61652C3C/Sensirion_CO2_Sensors_SCD30_Datasheet.pdf" target="_blank">SCD30: CO₂, Temperature, Humidity</a></li>
      <li><a href="https://sensirion.com/media/documents/B7AAA101/61653FB8/Sensirion_Particulate_Matter_AppNotes_Specification_Statement.pdf" target="_blank">SPS30: PM1.0, PM2.5, PM10</a></li>
      <li><a href="https://www.sgxsensortech.com/content/uploads/2014/08/0278_Datasheet-MiCS-4514.pdf" target="_blank">MiCS-4514: NO₂</a></li>
      <li><a href="https://www.analog.com/media/en/technical-documentation/data-sheets/ds3231.pdf" target="_blank">DS3231 RTC</a></li>
      <li><a>MicroSD Card Module</a></li>
      <li><a href="https://www.handsontec.com/dataspecs/I2C_2004_LCD.pdf" target="_blank">LCD Display</a></li>
      <li><a href="https://www.aliexpress.com/item/1005007835418978.html?invitationCode=K0FUeVlDeDZ2ZFRYRVp5RFNUdExlMFJ4aWJ5a2hXSk03U3dYclU4a3pwbWVQemFTZUJrNWVWT0s1MU1hdTAyWg&srcSns=sns_WhatsApp&spreadType=socialShare&social_params=61203957060&bizType=ProductDetail&spreadCode=K0FUeVlDeDZ2ZFRYRVp5RFNUdExlMFJ4aWJ5a2hXSk03U3dYclU4a3pwbWVQemFTZUJrNWVWT0s1MU1hdTAyWg&aff_fcid=b0967d1eb9c34e9e9376ad69358ea142-1754580035632-04850-_EQK9JGq&tt=MG&aff_fsk=_EQK9JGq&aff_platform=default&sk=_EQK9JGq&aff_trace_key=b0967d1eb9c34e9e9376ad69358ea142-1754580035632-04850-_EQK9JGq&shareId=61203957060&businessType=ProductDetail&platform=AE&terminal_id=90751b316c9447c6a2b7d018cc0672ff&afSmartRedirect=y" target="_blank">Li-Ion Battery Pack</a></li>
    </ul>
    <p>Wiring diagrams, schematic PDFs, and BOM available upon request.</p>
  </section>

  <!-- Enclosure Section -->
  <section id="enclosure">
    <h2>Enclosure & Mounting</h2>
    <p>The sensor enclosure was custom designed to allow optimal airflow and protection from debris. It was mounted to a vehicle dashboard using industrial double-sided tape and vent-mounted clips.</p>
    <ul>
      <li>Material: 3D printed PLA</li>
      <li>Design files: <a href="#">Download STL</a></li>
      <li>Mounting method: Dashboard adhesive + cable management</li>
      <li>Photos: <a href="#">View Gallery</a></li>
    </ul>
  </section>

  <!-- Deployment Section -->
  <section id="deployment">
    <h2>Deployment</h2>
    <p>Data was collected across various urban locations during rush hour. The device was powered by a 10,000mAh battery and uploaded readings via Wi-Fi (hotspot or public).</p>
    <ul>
      <li>Location: Dublin City, M50 Corridor</li>
      <li>Dates: July 2025</li>
      <li>Power runtime: ~6 hours continuous</li>
      <li>Data synced every 30 seconds to ThingSpeak and Blynk</li>
    </ul>
    <p>GPS data and maps can be integrated in future work.</p>
  </section>

  <footer>
    <p>&copy; 2025 Lauren Dwyer | MEng ECE | Final Year Thesis Project</p>
  </footer>

  <script>
    const tabGroups = {
      scd30: ['co2', 'temp', 'rh'],
      sps30: ['pm1', 'pm25', 'pm10'],
      mics: ['no2']
    };

    function showTab(id, el) {
      hideAllTabs();
      document.getElementById(id).style.display = 'block';
      document.querySelectorAll('.tablink').forEach(btn => btn.classList.remove('active'));
      if (el) el.classList.add('active');
      document.getElementById('sensorSelect').value = 'none';
    }

    function handleSensorSelect(sensor) {
      hideAllTabs();
      if (sensor in tabGroups) {
        tabGroups[sensor].forEach(id => {
          document.getElementById(id).style.display = 'block';
        });
        document.querySelectorAll('.tablink').forEach(btn => btn.classList.remove('active'));
      }
    }

    function hideAllTabs() {
      document.querySelectorAll('.tabcontent').forEach(el => el.style.display = 'none');
    }

    async function fetchThingSpeakData() {
      try {
        const response = await fetch('https://api.thingspeak.com/channels/2960675/feeds.json?results=1');
        const data = await response.json();
        if (data && data.feeds.length > 0) {
          const feed = data.feeds[0];
          document.getElementById('co2val').textContent = parseFloat(feed.field4).toFixed(1);
          document.getElementById('pm25val').textContent = parseFloat(feed.field2).toFixed(1);
          document.getElementById('pm10val').textContent = parseFloat(feed.field3).toFixed(1);
          document.getElementById('pm1val').textContent = parseFloat(feed.field1).toFixed(1);
          document.getElementById('tempval').textContent = parseFloat(feed.field5).toFixed(1);
          document.getElementById('humval').textContent = parseFloat(feed.field6).toFixed(1);
          document.getElementById('no2val').textContent = parseFloat(feed.field7).toFixed(3);
        }
      } catch (e) {
        console.error("ThingSpeak fetch failed:", e);
      }
    }

      function showSection(sectionId) {
    // Hide all sections
    const sections = document.querySelectorAll("section");
    sections.forEach(sec => sec.style.display = "none");

    // Show selected section
    const target = document.getElementById(sectionId);
    if (target) target.style.display = "block";

    // Update active nav link
    document.querySelectorAll(".navlink").forEach(link => link.classList.remove("active"));
    const activeLink = [...document.querySelectorAll(".navlink")].find(l => l.textContent.includes(target.querySelector("h2")?.textContent.split(' ')[0]));
    if (activeLink) activeLink.classList.add("active");
  }


    document.addEventListener("DOMContentLoaded", () => {
      showSection('sensor-overview');
      showTab('co2', document.querySelector(".tablink"));
      fetchThingSpeakData();
      setInterval(fetchThingSpeakData, 30000);
    });
  </script>
</body>
</html>
